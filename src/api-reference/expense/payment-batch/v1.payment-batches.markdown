---
title: Payment Batches v1.1
layout: reference
---


# Payment Batches
The Payment Batch File web service provides an automated solution to clients who would like to manage their payment batches and collect their batch files.


* [Retrieve the list of payment batches](#getpaymentbatches)
* [Close a payment batch asynchronously](#closepaymentbatch)
* [Close a payment batch synchronously](#closepaymentbatchsync)
* [Retrieve a payment batch file](#getbatchfile)
* [Error Messages](#errormessages)

### Version

* 1.1 for GET methods  
* 1.2 for POST method

## <a name="getpaymentbatches"></a>Retrieve the List of Payment Batches

Retrieves the list of payment batches with an optional requested status.

```
GET /expense/paymentbatch/v1.1/batchlist/
```

### Parameters

Name|Type|Format|Description
---|---|---|---
`batchlist`|`string`|-|**Required.** The batchlist keyword.
`Status`|`Boolean`|-|The status of the batches. Can be either OPEN or CLOSED.

### Response

Name|Type|Format|Description
---|---|---|---
`BatchName`|`string`|-|The batch name, as it appears in Payment Manager.
`BatchID`|`string`|-|The unique identifier for the batch.
`BatchTotal`|`Decimal`|-|The batch total amount.
`Currency`|`string`|-|The [3-letter ISO 4217 currency code](http://en.wikipedia.org/wiki/ISO_4217) for the batch.
`Count`|`string`|-|The number of payment demands in the batch.
`Type`|`string`|-|The payee of the batch. Either Employee or Card Program.
`PaymentMethod`|`string`|-|The reimbursement method for the batch. Either Expense Pay by SAP Concur, Company Check (via Accounts Payable), ADP (via EPIP file), or Other Reimbursement Methods.
`Batch-URL`|`string`|-|The URL to use as a basis for other actions, such as closing the batch.

## <a name="closepaymentbatch"></a>Close a Payment Batch Asynchronously
v1.2

This asynchronous request schedules closing of the specified batch, preventing any new expenses from entering it. After the batch closes, you can use Close Payment Batch v1.1 to get the File_URL to download the file containing the expense transaction information. 

> **Note**: You can check batch status using the Batch List API.

```
POST /expense/paymentbatch/v1.2/batch/{BatchID}/closed
```

### Parameters

Name|Type|Format|Description
---|---|---|---
`BatchID`|`string`|-|**Required.** The unique identifier for the batch.
`close`|`string`|-|**Required.** The close keyword.

### Response

Name|Type|Format|Description
---|---|---|---
`Status`|`string`|-|The status of the request to close the batch.
`JobQueueKey`|`string`|-|The unique identifier for the batch job.

## <a name="closepaymentbatchsync"></a>Close a Payment Batch Synchronously
(v1.1)

This request synchronously closes the batch preventing any new expenses from entering it. After the batch closes, SAP Concur creates the batch file containing the expense transaction information. If a batch ID for an already closed batch is sent, SAP Concur regenerates the batch file for the specified batch. 

This synchronous call has a time limit that can be superseded by the time it takes to close the batch. So it is recommended that close a payment batch (v1.2) be used to close batches asynchronously. Then use this request after the batch is closed to obtain the File-URL needed to download the file with the expense transaction information.

> **Note**: You can check batch status using the Batch List API.

```
POST /expense/paymentbatch/v1.1/batch/{BatchID}/close
```

### Parameters

Name|Type|Format|Description
---|---|---|---
`BatchID`|`string`|-|**Required.** The unique identifier for the batch.
`close`|`string`|-|**Required.** The close keyword.

### Response

Name|Type|Format|Description
---|---|---|---
`BatchStatus`|`string`|-|The current status of the specified batch.
`File-Url`|`string`|-|A URL for retrieving the extract file or files produced when the batch closes, with encrypted ID.
`Status`|`string`|-|The status of the request to close the batch.

## <a name="getbatchfile"></a>Retrieve a Payment Batch File

Requests the expense transaction data for the specified payment batch.

```
GET /expense/paymentbatch/v1.1/batch/{JobRunKey}/file
```

### Parameters

Name|Type|Format|Description
---|---|---|---
`JobRunKey`|`string`|-|**Required.**  The File-URL element returned by the Close Batches 1.1 API response contains the encrypted JobRunKey. In practice, you can simply use the File-URL whole value to download the file.

### Response

This request will return the expense transaction data in text/csv format if there was a single file produced or as a zip archive if the batch is configured to produce more than one file. An example of a client who will receive multiple files is a client using QuickBooks, who receives one file formatted for import into QuickBooks (.IIF extension), and one file for the general ledger (.CSV extension), inside a .ZIP file.  

## <a name="errormessages"></a>Error Messages

Error Number|Description
---|---
`500`|The batch you attempted to close does not contain any reports. If you recently approved reports for payment, wait 30 minutes and try again.

## <a name="erp-integration"></a>Enterprise Resource Planning Integration

For the purposes of ERP integration this API is available to Standard Edition. For Professional Edition use [Extracts v1 API ERP Integration](/api-reference/common/extracts/v1.extracts.html#erp-integration).

Before you begin, you need to close the Payment Manager batch using the appropriate APIs in order for you to retrieve the files using the API below. Ask your client not to close the batch manually through the User Interface.

1. Obtain a list of your clientâ€™s batches by using [Get list of batches](#getpaymentbatches)
1. Close the desired batch by using [Close a payment batch](#closepaymentbatch)
1. Retrieve the file you want by using [Retrieve a payment batch file](#getbatchfile)
